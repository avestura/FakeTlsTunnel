
# مقدمه
خوب آپدیت مالتی پورت هم منتشر شد
اولین نکته اینه که این برنامه رو مثل قبل میتونید حالت تک پورت بکار بگیرید و استفاده کنید بدون مشکل پس با خیال راحت اپدیت کنید.

برای استفاده از قابلیت مالتی پورت لطفا توضیحات را کامل بخونید و رد نکنید.

مالتی پورت یعنی اینکه روی سرور ایران کاربر به هرپورتی که وصل شد ؛‌ به همون پورت روی سرور خارج وصل بشه.
حتما با برنامه iptables کار کردین و میدونین که چطور میشه باهاش مالتی پورت تونل کرد.

اما این برنامه برای مالتی پورت یه فرقی با iptables داره که به نظر خودم مزیت حساب میشه.

فرقش اینه که کاربر به هرپورتی که به سرور ایران وصل شد ؛ مستقیم وصل نمیشه به همون پورت روی سرور خارج! 
بلکه درخواستش میره به یک پورت داخل سرور خارج! کودوم پورت ؟ همون پورتی که توی دستور سرور ایران میزنید

--toport

و سرور خارج هم باید همین پورت رو گوش کنه در نتیجه روی سرور خارج هم باید همین پورت رو بزارید در 

--lport

و بهتره که این پورت ها ۴۴۳ باشن برای فیلتر نشدن.

خوب گفتم درخواست از هرپورتی روی سرور ایران جمع اوری میشه و ارسال میشه به یک پورت سرور خارج که همین الان گفتم کودوم پورت و بعد سرور خارج میفهمه دستور به کودوم پورت سرور ایران اومده بود و دیتا رو میفرسته به همون پورت روی سرور خودش! و این از دیدگاه امنیت و فیلتر نشدن سرور خارج خیلی نکته خوبیه. چون فقط دیتا به یه پورت سرور خارج میره مثل یه سایت عادی.




# مثال
من میخوام تمام پورت های سرور ام به جز پورت ssh که ۲۲ هست ؛ را فوروارد کنم.
روی سرور ایران دستور رو این شکلی اجرا میکنم
```sh
./FTT --tunnel --lport:23-65535 --toip:1.2.3.4 --toport:443  --password:123ab --sni:sni.com
```

و روی سرور خارج هم این رو اجرا میکنم
```sh
./FTT --server --lport:443 --toip:127.0.0.1 --toport:9999  --password:123ab --sni:sni.com --multiport
```
چند تا نکته مهم هست ایجا:

# نکات مهم سرور ایران

سرور ایران وقتی که بهش پورت رو به صورت بازه بدین (همین مثالی که زدیم) میفهمه حالت مالتی پورت هست و درنتیجه:

روی سرور ایران تمام rule های iptables ریست میشه ! این برای کارکرد صحیح برنامه لازمه و باید باشه اما اگه واقعا مجبورید رول های قبلی رو نگه دارید

--keep-iptables

رو به دستور سرور ایران اضافه کنید که پیشنهاد نمیکنم.


روی سرور ایران حتما باید iptables نصب باشه که روی ابونتو هست همیشه اگه سیستم عاملی داشتین که iptables روش نصب نبود باید نصب کنید ؛ برنامه ارور میده اگه نصب نباشه.

برنامه فقط برای دریافت دیتا از پورت های مختلف به خودش ؛ به iptables نیاز منده واسه همین نیاز هست که نصب باشه و iptables در انتقال دیتا هیچ نقشی نداره.

# نکات مهم سرور خارج

وقتی که داخل دستور سرور خارج

--multiport

باشه ؛ میفهمه که روی سرور ایران حالت مالتی پورت فعال شده و وقتی حالت مالتیپورت فعال باشه ؛ دیگه نیازی به 

--toport

روی سرور خارج نیست و هر عددی دوست دارید بزارید اصلا مهم نیست چون این پورت رو از سرور ایران خواهد گرفت.

